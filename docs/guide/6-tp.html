<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
	<head>
		<title>The Post-Weave</title>
<link href="../docs-assets/Breadcrumbs.css" rel="stylesheet" rev="stylesheet" type="text/css">
		<meta name="viewport" content="width=device-width initial-scale=1">
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<meta http-equiv="Content-Language" content="en-gb">

<link href="../docs-assets/Contents.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Progress.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Navigation.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Fonts.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Base.css" rel="stylesheet" rev="stylesheet" type="text/css">
<script src="http://code.jquery.com/jquery-1.12.4.min.js"
	integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>

<script src="../docs-assets/Bigfoot.js"></script>
<link href="../docs-assets/Bigfoot.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Colours.css" rel="stylesheet" rev="stylesheet" type="text/css">
		
	</head>
	<body class="commentary-font">
		<nav role="navigation">
		<h1><a href="../index.html"><img src="../docs-assets/Octagram.png" height=72> </a></h1>
<ul><li><a href="../inweb/index.html">inweb</a></li>
</ul><h2>Foundation Modules</h2><ul>
<li><a href="../foundation-module/index.html">foundation</a></li>
<li><a href="../foundation-test/index.html">foundation-test</a></li>
<li><a href="../literate-module/index.html">literate</a></li>
<li><a href="../literate-test/index.html">literate-test</a></li>
</ul><h2>Documentation</h2><ul>
<li><a href="index.html"><span class="selectedlink">guide</span></a></li>
</ul><h2>Example Webs</h2><ul>
<li><a href="../goldbach/index.html">goldbach</a></li>
<li><a href="../twinprimes/twinprimes.html">twinprimes</a></li>
<li><a href="../eastertide/index.html">eastertide</a></li>
</ul><h2>Repository</h2><ul>
<li><a href="https://github.com/ganelson/inweb"><img src="../docs-assets/github.png" height=0> github</a></li>
</ul><h2>Related Projects</h2><ul>
<li><a href="https://github.com/ganelson/inform"><img src="../docs-assets/github.png" height=0> inform</a></li>
<li><a href="https://github.com/ganelson/intest"><img src="../docs-assets/github.png" height=0> intest</a></li>
</ul>
		</nav>
		<main role="main">
		<!-- Weave of 'The Post-Weave' generated by inweb -->
<div class="breadcrumbs">
    <ul class="crumbs"><li><a href="../index.html">Home</a></li><li><a href="index.html">The Inweb Guide</a></li><li><a href="index.html#6">Chapter 6: Patterns</a></li><li><b>The Post-Weave</b></li></ul></div>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP1" class="paragraph-anchor"></a> The <em>post-weave</em>, very much the après-ski experience of weaving, is a moment
when Inweb can (if a pattern has told it to) perform some follow-on work with
the documents it has just woven. As with the après-ski, by default nothing
happens.</p>
<p>In fact, nothing will ever happen unless the pattern for a weave has a
declaration containing a <code>commands</code> block. The only pattern supplied with Inweb which does have
<code>commands</code> is <code>PDFTeX</code>, whose declaration reads:</p>
<pre><code>Pattern &quot;PDFTeX&quot; {
	based on: TeX
	initial extension: .tex
	commands
		pdftex -output-directory=WOVENPATH -interaction=scrollmode WOVEN.tex &gt;WOVEN.console
		PROCESS WOVEN.log
		rm WOVEN.log
		rm WOVEN.console
	end
}
</code></pre>
<p>The conundrum here is this. <code>PDFTeX</code> wants to produce PDF documents. But Inweb
can only produce TeX source code: for this to be turned into a PDF, it needs
to be run through some external tools — not least some form of TeX. Inweb cannot
contain those tools within itself, so it has to call out to the surrounding
operating system's shell. This is what the commands do.</p>
<p>This feature might not seem worth it for a single file, but bear in mind that
Inweb might be producing 200-odd files at a time, one for each section of a
large web. It's much more convenient to have Inweb manage the process of
turning all those individual TeX files into PDFs, not least because Inweb
will get their fiddly filenames correct.</p>
<p>Each line of the <code>commands</code> block is a shell command, <em>unless</em> it has the
form <code>PROCESS filename</code>. This gives Inweb the chance to look at the file if
it wants to. That's in practice only ever going to be useful for TeX: what
Inweb does is to scan through the output produced by TeX to see if there
have been overfull hbox errors, count the number of pages, and such. So,
really, it should be used only by the definition above.</p>
<p>Here is the above post-weave system in action:</p>
<pre><code>$ inweb weave pyramid.c.md -as PDFTeX
weaving web &quot;Hilbert's Pyramid&quot; (C program in MarkdownCode notation) as PDFTeX (based on TeX)
(pdftex -output-directory='.'  -interaction=scrollmode 'pyramid.tex'  &gt;'pyramid.console')
(rm 'pyramid.log')
(rm 'pyramid.console')
	generated: pyramid.tex
</code></pre>
<p>Note that <code>WOVENPATH</code> in one command has become <code>.</code> (the output directory
happens to be the current working directory here), while each <code>WOVEN</code> has
become <code>pyramid</code>. Note that <code>WOVEN</code> cannot begin with <code>-</code>, or contain any
spaces, so the command <code>rm WOVEN.log</code> is not quite the invitation to walk
through a graveyard at night that it might seem. Those are the only two
substitutions made by Inweb when it passes these commands to the system
shell.</p>
</div>
<nav role="progress"><div class="progresscontainer">
    <ul class="progressbar"><li class="progressprev"><a href="6-am.html">&#10094;</a></li><li class="progresschapter"><a href="1-gs.html">1</a></li><li class="progresschapter"><a href="2-cp.html">2</a></li><li class="progresschapter"><a href="3-cln.html">3</a></li><li class="progresschapter"><a href="4-an.html">4</a></li><li class="progresschapter"><a href="5-al.html">5</a></li><li class="progresscurrentchapter">6</li><li class="progresssection"><a href="6-ap.html">ap</a></li><li class="progresssection"><a href="6-cp.html">cp</a></li><li class="progresssection"><a href="6-cll.html">cll</a></li><li class="progresssection"><a href="6-am.html">am</a></li><li class="progresscurrent">tp</li><li class="progresssection"><a href="6-sop.html">sop</a></li><li class="progresschapter"><a href="7-bn.html">7</a></li><li class="progressnext"><a href="6-sop.html">&#10095;</a></li></ul></div>
</nav><!-- End of weave -->

		</main>
	</body>
</html>

