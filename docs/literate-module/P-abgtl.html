<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
	<head>
		<title>A Brief Guide to Literate</title>
<link href="../docs-assets/Breadcrumbs.css" rel="stylesheet" rev="stylesheet" type="text/css">
		<meta name="viewport" content="width=device-width initial-scale=1">
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<meta http-equiv="Content-Language" content="en-gb">

<link href="../docs-assets/Contents.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Progress.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Navigation.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Fonts.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Base.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Colours.css" rel="stylesheet" rev="stylesheet" type="text/css">
		
	</head>
	<body class="commentary-font">
		<nav role="navigation">
		<h1><a href="../index.html"><img src="../docs-assets/Octagram.png" height=72> </a></h1>
<ul><li><a href="../inweb/index.html">inweb</a></li>
</ul><h2>Foundation Modules</h2><ul>
<li><a href="../foundation-module/index.html">foundation</a></li>
<li><a href="../foundation-test/index.html">foundation-test</a></li>
<li><a href="index.html"><span class="selectedlink">literate</span></a></li>
<li><a href="../literate-test/index.html">literate-test</a></li>
</ul><h2>Example Webs</h2><ul>
<li><a href="../goldbach/index.html">goldbach</a></li>
<li><a href="../twinprimes/twinprimes.html">twinprimes</a></li>
<li><a href="../eastertide/index.html">eastertide</a></li>
</ul><h2>Repository</h2><ul>
<li><a href="https://github.com/ganelson/inweb"><img src="../docs-assets/github.png" height=0> github</a></li>
</ul><h2>Related Projects</h2><ul>
<li><a href="https://github.com/ganelson/inform"><img src="../docs-assets/github.png" height=0> inform</a></li>
<li><a href="https://github.com/ganelson/intest"><img src="../docs-assets/github.png" height=0> intest</a></li>
</ul>
		</nav>
		<main role="main">
		<!-- Weave of 'A Brief Guide to Literate' generated by inweb -->
<div class="breadcrumbs">
    <ul class="crumbs"><li><a href="../index.html">Home</a></li><li><a href="index.html">literate</a></li><li><a href="index.html#P">Preliminaries</a></li><li><b>A Brief Guide to Literate</b></li></ul></div>
<p class="purpose">Notes on using the Literate library.</p>

<ul class="toc"><li><a href="P-abgtl.html#SP1">&#167;1. Introduction</a></li><li><a href="P-abgtl.html#SP2">&#167;2. Importing the module</a></li><li><a href="P-abgtl.html#SP3">&#167;3. Literate programming</a></li></ul><hr class="tocbar">

<p class="commentary firstcommentary"><a id="SP1" class="paragraph-anchor"></a><b>&#167;1. Introduction.</b>The Literate library builds on <a href="../foundation-module/index.html" class="internal">foundation</a> and provides an extensive suite
of code to handle "literate programs".
</p>

<p class="commentary">A tool can import <a href="index.html" class="internal">literate</a> only if it also imports <a href="../foundation-module/index.html" class="internal">foundation</a>.
</p>

<p class="commentary firstcommentary"><a id="SP2" class="paragraph-anchor"></a><b>&#167;2. Importing the module.</b>We'll use the term "parent" to mean the tool which is importing <a href="index.html" class="internal">literate</a>,
that is, which will include its code and be able to use it. As with any
imported module,
</p>

<ul class="items"><li>&#9679; The contents page of the parent's web must identify and locate the
module:
</li></ul>
<pre class="displayed-code all-displayed-code code-font">
<span class="element-syntax">Import</span><span class="plain-syntax">:</span><span class="string-syntax"> literate</span>
</pre>
<ul class="items"><li>&#9679; The parent must call <span class="extract"><span class="extract-syntax">LiterateModule::start()</span></span> just after it starts up, and
<span class="extract"><span class="extract-syntax">LiterateModule::end()</span></span> just before it shuts down. (But just after, and just
before, the corresponding calls to <a href="../foundation-module/index.html" class="internal">foundation</a>.)
</li></ul>
<p class="commentary firstcommentary"><a id="SP3" class="paragraph-anchor"></a><b>&#167;3. Literate programming.</b>This library was created to serve a family of compilers which all make use of
ideas from "literate programming", and they provide extensive support for
parsing, weaving and tangling webs of LP source code. These are used not only to
build, for example, the Inform compiler, but also within that compiler, to read
literate source.
</p>

<p class="commentary">This isn't the place to explain what a literate program is: if you're reading
this, you're looking at one. But the terminology and data structures we use
might be worth a brief overview:
</p>

<p class="commentary">A "web" is a literate-programming expression of either a stand-alone program,
or a library of code which can be "imported" by other webs. Each web is
represented in the filing system either by its own private directory of
resources, which is good for larger programs or libraries, or more simply
by a single file, which is less fuss for simpler programs. Each web is
represented in memory by an <span class="extract"><span class="extract-syntax">ls_web</span></span> structure.
</p>

<p class="commentary">A web is basically some metadata together with some literate code divided
into chapters, each represented by an <span class="extract"><span class="extract-syntax">ls_chapter</span></span>. A chapter is further
divided into sections, each an <span class="extract"><span class="extract-syntax">ls_section</span></span>. Small single-file webs don't
appear to have these, but in fact they do: there's an implicit chapter
containing an implicit section, which contains the program. Middle-sized
webs divided into section files in the filing system similarly have an implicit
chapter to hold those sections. So all webs of every size have an <span class="extract"><span class="extract-syntax">ls_web</span></span>
holding <span class="extract"><span class="extract-syntax">ls_chapter</span></span> holding <span class="extract"><span class="extract-syntax">ls_section</span></span> hierarchy.
</p>

<p class="commentary">Because one web can import another one (see above), it may contain chapters
drawn from multiple sources. These are called its "modules", and represented by
<span class="extract"><span class="extract-syntax">ls_module</span></span> structures. A simple web which imports nothing has just one "main
module", holding its entire source. But if a web representing tool X imports
library L, then there will be two modules for X: the main module and also the
module of code imported from L. Since an imported module might then import other
modules in turn, the modules of a web form a small dependency graph, of which
the main module is the root.
</p>

<p class="commentary firstcommentary"><a id="SP4" class="paragraph-anchor"></a><b>&#167;4. </b>Each section then contains a single "unit" of literate source, held in an <span class="extract"><span class="extract-syntax">ls_unit</span></span>.
This consists of <span class="extract"><span class="extract-syntax">ls_paragraph</span></span> objects, which in turn are divided into <span class="extract"><span class="extract-syntax">ls_chunk</span></span>
objects, which in turn contain <span class="extract"><span class="extract-syntax">ls_line</span></span> objects. This paragraph you're reading
is a single <span class="extract"><span class="extract-syntax">ls_paragraph</span></span>, containing a single <span class="extract"><span class="extract-syntax">ls_chunk</span></span>, with 11 <span class="extract"><span class="extract-syntax">ls_line</span></span>s (one
blank). More complex paragraphs might have a chunk of commentary text, then some
definitions (each of which is another chunk), then a block of code (another chunk
again).
</p>

<p class="commentary">Fragments of source code which are part of the program to be compiled are called
"holons". So only some chunks are holons, and details of the code they hold are
held in <span class="extract"><span class="extract-syntax">ls_holon</span></span> objects. (Note that a definition of a symbol is not a holon.)
</p>

<p class="commentary">Parsing a unit mostly involves "classifying" its lines according to the current
notation being used for LP. We support multiple notations, with the current
parsing rules being expressed as an <span class="extract"><span class="extract-syntax">ls_notation</span></span> object. Classification of a
line produces <span class="extract"><span class="extract-syntax">ls_class</span></span> objects as intermediate results, and if it goes badly
then it can also produce errors, each stored as an <span class="extract"><span class="extract-syntax">ls_error</span></span>.
</p>

<p class="commentary firstcommentary"><a id="SP5" class="paragraph-anchor"></a><b>&#167;5. </b>To sum up, then, webs are stored in the following nine structures:
</p>

<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">    </span><span class="reserved-syntax">ls_web</span>
<span class="plain-syntax">        </span><span class="identifier-syntax">with</span><span class="plain-syntax"> </span><span class="identifier-syntax">tree</span><span class="plain-syntax"> </span><span class="identifier-syntax">of</span><span class="plain-syntax"> </span><span class="identifier-syntax">at</span><span class="plain-syntax"> </span><span class="identifier-syntax">least</span><span class="plain-syntax"> </span><span class="constant-syntax">1</span><span class="plain-syntax"> </span><span class="reserved-syntax">ls_module</span>
<span class="plain-syntax">        </span><span class="identifier-syntax">and</span><span class="plain-syntax"> </span><span class="identifier-syntax">list</span><span class="plain-syntax"> </span><span class="identifier-syntax">of</span><span class="plain-syntax"> </span><span class="constant-syntax">1</span><span class="plain-syntax"> </span><span class="identifier-syntax">or</span><span class="plain-syntax"> </span><span class="identifier-syntax">more</span><span class="plain-syntax"> </span><span class="reserved-syntax">ls_chapter</span>
<span class="plain-syntax">            </span><span class="identifier-syntax">each</span><span class="plain-syntax"> </span><span class="identifier-syntax">with</span><span class="plain-syntax"> </span><span class="identifier-syntax">list</span><span class="plain-syntax"> </span><span class="identifier-syntax">of</span><span class="plain-syntax"> </span><span class="constant-syntax">1</span><span class="plain-syntax"> </span><span class="identifier-syntax">or</span><span class="plain-syntax"> </span><span class="identifier-syntax">more</span><span class="plain-syntax"> </span><span class="reserved-syntax">ls_section</span>
<span class="plain-syntax">                </span><span class="identifier-syntax">each</span><span class="plain-syntax"> </span><span class="identifier-syntax">with</span><span class="plain-syntax"> </span><span class="identifier-syntax">exactly</span><span class="plain-syntax"> </span><span class="constant-syntax">1</span><span class="plain-syntax"> </span><span class="reserved-syntax">ls_unit</span>
<span class="plain-syntax">                    </span><span class="identifier-syntax">each</span><span class="plain-syntax"> </span><span class="identifier-syntax">with</span><span class="plain-syntax"> </span><span class="identifier-syntax">list</span><span class="plain-syntax"> </span><span class="identifier-syntax">of</span><span class="plain-syntax"> </span><span class="constant-syntax">0</span><span class="plain-syntax"> </span><span class="identifier-syntax">or</span><span class="plain-syntax"> </span><span class="identifier-syntax">more</span><span class="plain-syntax"> </span><span class="reserved-syntax">ls_paragraph</span>
<span class="plain-syntax">                        </span><span class="identifier-syntax">each</span><span class="plain-syntax"> </span><span class="identifier-syntax">with</span><span class="plain-syntax"> </span><span class="identifier-syntax">list</span><span class="plain-syntax"> </span><span class="identifier-syntax">of</span><span class="plain-syntax"> </span><span class="constant-syntax">1</span><span class="plain-syntax"> </span><span class="identifier-syntax">or</span><span class="plain-syntax"> </span><span class="identifier-syntax">more</span><span class="plain-syntax"> </span><span class="reserved-syntax">ls_chunk</span>
<span class="plain-syntax">                            </span><span class="identifier-syntax">where</span><span class="plain-syntax"> </span><span class="identifier-syntax">one</span><span class="plain-syntax"> </span><span class="identifier-syntax">chunk</span><span class="plain-syntax"> </span><span class="identifier-syntax">in</span><span class="plain-syntax"> </span><span class="identifier-syntax">the</span><span class="plain-syntax"> </span><span class="identifier-syntax">list</span><span class="plain-syntax"> </span><span class="identifier-syntax">may</span><span class="plain-syntax"> </span><span class="identifier-syntax">have</span><span class="plain-syntax"> </span><span class="constant-syntax">1</span><span class="plain-syntax"> </span><span class="reserved-syntax">ls_holon</span>
<span class="plain-syntax">                            </span><span class="identifier-syntax">and</span><span class="plain-syntax"> </span><span class="identifier-syntax">every</span><span class="plain-syntax"> </span><span class="identifier-syntax">chunk</span><span class="plain-syntax"> </span><span class="identifier-syntax">has</span><span class="plain-syntax"> </span><span class="identifier-syntax">a</span><span class="plain-syntax"> </span><span class="identifier-syntax">list</span><span class="plain-syntax"> </span><span class="identifier-syntax">of</span><span class="plain-syntax"> </span><span class="constant-syntax">1</span><span class="plain-syntax"> </span><span class="identifier-syntax">or</span><span class="plain-syntax"> </span><span class="identifier-syntax">more</span><span class="plain-syntax"> </span><span class="reserved-syntax">ls_line</span>
<span class="plain-syntax">                    </span><span class="identifier-syntax">and</span><span class="plain-syntax"> </span><span class="identifier-syntax">a</span><span class="plain-syntax"> </span><span class="identifier-syntax">list</span><span class="plain-syntax"> </span><span class="identifier-syntax">of</span><span class="plain-syntax"> </span><span class="constant-syntax">0</span><span class="plain-syntax"> </span><span class="identifier-syntax">or</span><span class="plain-syntax"> </span><span class="identifier-syntax">more</span><span class="plain-syntax"> </span><span class="reserved-syntax">ls_error</span>
</pre>
<p class="commentary">Note that a web must have at least one chapter, each chapter must have at
least one section, each paragraph must have at least one chunk, and each
chunk must have at least one line. The empty program would be stored as:
</p>

<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">    </span><span class="reserved-syntax">ls_web</span>
<span class="plain-syntax">        </span><span class="constant-syntax">1</span><span class="plain-syntax"> </span><span class="reserved-syntax">ls_module</span>
<span class="plain-syntax">        </span><span class="constant-syntax">1</span><span class="plain-syntax"> </span><span class="reserved-syntax">ls_chapter</span>
<span class="plain-syntax">            </span><span class="constant-syntax">1</span><span class="plain-syntax"> </span><span class="reserved-syntax">ls_section</span>
<span class="plain-syntax">                </span><span class="constant-syntax">1</span><span class="plain-syntax"> </span><span class="reserved-syntax">ls_unit</span>
<span class="plain-syntax">                    </span><span class="identifier-syntax">with</span><span class="plain-syntax"> </span><span class="constant-syntax">0</span><span class="plain-syntax"> </span><span class="reserved-syntax">ls_paragraph</span><span class="plain-syntax"> </span><span class="identifier-syntax">objects</span>
</pre>
<p class="commentary firstcommentary"><a id="SP6" class="paragraph-anchor"></a><b>&#167;6. </b>The fundamental things we can do with a web, then, are:
</p>

<ul class="items"><li>(a) Parsing. Literate source has highly customisable markup syntax: see
<a href="2-wn.html" class="internal">Web Notations</a>.
</li><li>(b) Tangling. See <a href="4-tt2.html" class="internal">The Tangler</a> for how this is done. Note that tangling
can be performed entirely in memory, so that tools such as Inform can read
literate source and tangle it internally, avoiding the need for secondary
LP tools or intermediate files stored on disc.
</li><li>(c) Weaving. See <a href="5-ts.html" class="internal">The Swarm</a> for an overview of how complex weaves are
divided into a "swarm" of simple ones, each of which generates a "weave tree"
of rendering instructions. See <a href="5-fm.html" class="internal">Format Methods</a> and its subsidiaries,
such as <a href="5-hf.html" class="internal">HTML Formats</a>, for the actual process of rendering weave output
from the tree.
</li></ul>
<p class="commentary firstcommentary"><a id="SP7" class="paragraph-anchor"></a><b>&#167;7. </b>Literate programs are, at the end of the day, still programs, and are
written in programming languages. We need to understand those languages
at least a little in order to syntax-colour them when weaving, and also
in order to provide convenient tangling features when tangling. See
<a href="3-pl.html" class="internal">Programming Languages</a> for how we define their syntactic and other quirks.
</p>

<p class="commentary">Languages declaring themselves "C-like" have access to special tangling
facilities, all implemented with non-ACME method calls: see <a href="3-cl.html" class="internal">C-Like Languages</a>.
In particular, for coping with how <span class="extract"><span class="extract-syntax">#ifdef</span></span> affects <span class="extract"><span class="extract-syntax">#include</span></span> see
<a href="3-cl.html#SP5" class="internal">CLike::additional_early_matter</a>; for predeclaration of functions and
structs and <span class="extract"><span class="extract-syntax">typedef</span></span>s, see <a href="3-cl.html#SP6" class="internal">CLike::additional_predeclarations</a>.
</p>

<p class="commentary">A special language calling itself "InC" gets even more: see <a href="3-is.html" class="internal">InC Support</a>, and
in particular <a href="3-is.html#SP5" class="internal">text_literal</a> for text constants like <span class="extract"><span class="extract-syntax">I"banana"</span></span>
and <a href="3-is.html#SP3" class="internal">preform_nonterminal</a> for Preform grammar notation like
<span class="extract"><span class="extract-syntax">&lt;sentence-ending&gt;</span></span>. "InC" is basically a more convenient form of C, and
is the language in which the foundation library is written.
</p>

<p class="commentary firstcommentary"><a id="SP8" class="paragraph-anchor"></a><b>&#167;8. </b>There are also some minor conveniences for setting up Github repositories
which contain literate programs. In particular, we use the preprocessor of
<a href="../foundation-module/index.html" class="internal">foundation</a> to construct <a href="6-mkf.html" class="internal">Makefiles</a> and the like: see also <a href="6-gs.html" class="internal">Git Support</a>,
which helps with <span class="extract"><span class="extract-syntax">.gitignore</span></span> creation, and <a href="6-rw.html" class="internal">Readme Writeme</a>, a convenient
utility for generating <span class="extract"><span class="extract-syntax">README.md</span></span> files for GitHub repositories.
</p>

<nav role="progress"><div class="progresscontainer">
    <ul class="progressbar"><li class="progressprevoff">&#10094;</li><li class="progresscurrentchapter">P</li><li class="progresscurrent">abgtl</li><li class="progresschapter"><a href="1-lm.html">1</a></li><li class="progresschapter"><a href="2-ls.html">2</a></li><li class="progresschapter"><a href="3-pl.html">3</a></li><li class="progresschapter"><a href="4-tt.html">4</a></li><li class="progresschapter"><a href="5-wd.html">5</a></li><li class="progresschapter"><a href="6-mkf.html">6</a></li><li class="progressnext"><a href="1-lm.html">&#10095;</a></li></ul></div>
</nav><!-- End of weave -->

		</main>
	</body>
</html>

